sudo: required
language: java
jdk:
  - oraclejdk8
cache:
  directories:
    - "$HOME/.m2/repository"
before_cache:
  - rm -rf $HOME/.m2/repository/com/opengamma/margining
# install
before_install:
  - echo "MAVEN_OPTS='-Xms512m -Xmx2g'" > ~/.mavenrc
install:
  - mvn --version
script:
# build
  - mvn install -e -B -DintegrationTest -Ddist
# deploy
  - if [[ $TRAVIS_TAG =~ ^v.*$ ]] && [ "$TRAVIS_PULL_REQUEST" == "false" ]; then mvn deploy -Ddist -DaltDeploymentRepository="og-public-release::default::https://api.bintray.com/maven/opengamma/releases/JavaSDK/" --settings .github/deploy-settings.xml; fi
# secure keys for DEPLOY_USER, DEPLOY_PASSWORD, MARGIN_API_KEY, MARGIN_API_SECRET
env:
  global:
  - secure: IQ+YQIdIyDXASYXAiKzxr7dPIpbmFJ8bsnSYj7zHRjSsu5sY3Cs7q3LFGlCnCEySEa+iqBtpbeqiiC0I4xW2sMuBEjoz/vQo9xNFGLdE5k3QYM9ykTzRln+DVB9T+Oq3E+jM7msvQfHJSrT3wq9zQZ/EjIO/A6/QdEwA2p7qe+S1MXpK10D19vri6+JnH38UorN1IPTTzxVgH2gU6qhxmc1ZF5F4EbCblES1fhYOLcMjncZlcxLzDWWDczlbLLR+VuxeXlnkk5Er2H0xjPp2TRa4y9OaQ89upfKVHefWCkJx0AnkFqJFYsNF2hUtA1KIz7+MgEGCXa6rtHYwlWnhTQuh9bXlWZg68abPw9YalgKFck2QZYIxZQz+gglCpEoc+J6qSIzJyMAopWCE1vRr25aTfFaWnngEkHh23GXmjUdD+SDZroDfWEy+8SFJbYIIF/HDnX+nzrJ4021g6i7VnrsEQSAIG9Ea7LBOVSF+6fl5o2wpJHf24TnPN1xSvKD/Mh+X6lUgqro0wxTmHD49RVIyBky0GRj3Zq0SF4/Rr7pBXeWdzEoWcjydbPVxYSkxFlWKcAl6jYycd1Gkn1RL/+Kq45LsL/s0rzSoIFVYJlqYJaJkDG6oC1DzDZ5TGvvF4UlI4qIbmIrrfTsTrT04SNklXxiwFt6SvGwTYM7aNiY=
  - secure: Hr6hIbFnzALCRxcXDb+LUBePJFBTcsyTt/Aab2/WQfdSeMOSmQ6OPMqnU//0jH3R907Icp+znQTy2TEseWYg9b3ZmCYebMDTgg0B/HYetguGZPaBmaHE2BKixG/P4pb4p/LcpDt5C58zM1+doLH5lUxfyscCughxQ20OzdlJHFsOowt1RTGNU/7RBiWiQP08rwJkdlReLiIJP6ghu8mvIyPCvw0UYFRGZeQUUJe0TyGhsfKTIjkuV4iItf9vdBW7ziqDp4hwAhYaw+vtMYwGkSjg1VGLqsEeWeRe1EVqxhAsLdEeXrPH00lHaq9FwjAWcXXwOWxvNANTMS0LfVxBtd3qKFgYAe5MaRRSGso/Zv4Y+7mpyr58T+oTsX8RtGTXF0U+m5qzQvSM2i63ig6RgvffH8hCUuL55MXyySZ1ypPcV6pRdZfHBRqEQeOOE/1f1nnrOsf55VsQjMlxJyD5U0xcPp+Lypoj6nvioBe1/7J9eedoaQVDXdn4SNVZcrlmY1TgJlXcNxpeQZFvHaQTLaPcwct5VPwPbvdoigdmy8bNl8V8bA9I089JOCoFgfz9FE9CFUv+5T3//dN84krp1/g4/G/25NfLKpoO/FPYMK04T7dT28B9PXSG5/jw4z9Qk0ioSbk+RbmKoR/1O58haJYRu3uOwAUhceosveqs8A0=
  - secure: X8T5KO7Z2sAtLc9HAxx6Fe98lCRri/F+62X5QoMd3tZT14Ii+bTKqdGvKbphlsbl/oSkdMgynrIdeAG9rxrnxLhDjwX+Vxkypq5+WMjIEuy0o8hW/ZNQytAv7l5xQkBdlkLigf6t09mtRYzXFRfmOlBeD+Ve+OPvYKkW4Wy9t2sIxoML28wBdzAdTmnzstvolJHauliVhGrCR1H+n/FQp8bktqUaUy5KgSW8ThHJIrcIHlVIr6Kgarc3duyk6/BrHXkMKyPqLK3JZtUphRSeuBQQDeR+x/G0QeoQEQ+UhpHqyPo+WeYp2K2J8+SxsMVNQ2JxQqsjWRqwlilQ+ftER18sR+jwC+cDojyLQf6H/ishJojPPs64/O4X0N8NKygxo/MCLe2+jj6XeqC9m5W4ZS0npdXtvGaSIhWUiu5JLMHL/NACEjoikctVtI2P7DvsHmVNBY+rDw1Y0R6+uCKdtup3iBGHO6Abi3E89B3aBg4pooLEWviIcsSDRIrP1glLPfspacUYGSJzG4Nb2prZEzqXN8Qd/2f/msu3NHmXAMWAYnN7omp/UiL0BMbE99vHxaWIC0qsYHVl//ahAggN8jfgcQRJ6bjrmCTm9Sz+bwSYSHtpTYgBZVJyKGB40EEnzS2MQcaOHvghlu7th1UPhM1EWX7wtq7jkEbl8B5WA5U=
  - secure: Tm5Tdpsez3EMPR3yL6aXL02kZSZdMAGgzMCViCrMwJnBxdQHvCgfbad//owxByTb+EgRcMHZCkT8WfBkaPNUff9hJ9ijRwjJ1XT+KjqGEmkiXyF3Dnt3ALuOKrrZNiDZJKOKjmLXXuxs1y0xQ6Odj0OkHejPph61EHGoPPF+qR2lNZvGReiMdZm7iyp4LzUVLfuVwxt2jBNrCOtEHD2N6+4arSDNA67Can+sFjuQfYPv3F2mVy7VApooCwVy3mGsH7a3p6kmugwZj8qW6mlqSjQUll+XBEOfE8CCVhcRx4iXytPoj+WFIUcwrIZCZIr2Jzf55vkkUo32Sc/QVxWft26pnXPuzK046NZHYz/Un3oVfbEDb6qBiV04cAhH/Cr2LwNp+UijYM0rIhSTQZmrwkotEkRCFxMM/7tIYXjd87CGwyPbclzzBkyWA2L93xTmpyiV7idt9+ZW5CuBgFteRxA3zXnUhu2TUeJlQw/M6iEyFuN0T0Ep2ByqL/Yw9zE+6VjqJZEBZwibQbMR4YfQ0yFGEUGYMtANDKjQEX18ybeM0t1f2t2Bswh3DvsjucdivSbpCTeQwT3ED2yMAgdXyjJhwKVhPwNQ3a5OgDfNYelCPP3MmHeyRE4tl0hmmjRzR4MrWJh+cFnwy11hVLvdAhx10mVGrFPsLeRPe7fdy8Y=
